# ComfyUI ç§»åŠ¨ç«¯WebæœåŠ¡

ä¸€ä¸ªç§»åŠ¨ç«¯å‹å¥½çš„ComfyUIå·¥ä½œæµé€‰æ‹©å’Œæ‰§è¡Œç•Œé¢ï¼Œæ”¯æŒç›´æ¥åœ¨æ‰‹æœºæˆ–å¹³æ¿ä¸Šè¿è¡ŒComfyUIå·¥ä½œæµã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ“± **ç§»åŠ¨ç«¯ä¼˜åŒ–** - å®Œå…¨å“åº”å¼è®¾è®¡ï¼Œå®Œç¾é€‚é…æ‰‹æœºå’Œå¹³æ¿
- ğŸš€ **ä¸€é”®è¿è¡Œ** - ç®€å•ç‚¹å‡»å³å¯æ‰§è¡ŒComfyUIå·¥ä½œæµ
- ğŸ“Š **å®æ—¶çŠ¶æ€** - å®æ—¶æ˜¾ç¤ºå·¥ä½œæµæ‰§è¡Œè¿›åº¦å’ŒçŠ¶æ€
- ğŸ” **æ™ºèƒ½æœç´¢** - å¿«é€Ÿæœç´¢å’Œç­›é€‰å·¥ä½œæµ
- ğŸ’« **ç°ä»£ç•Œé¢** - ä¼˜ç¾çš„ç°ä»£åŒ–ç”¨æˆ·ç•Œé¢
- âš¡ **é«˜æ€§èƒ½** - å¼‚æ­¥å¤„ç†ï¼Œæ”¯æŒå¤šä»»åŠ¡å¹¶å‘

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.7+
- ComfyUIå·²å®‰è£…å¹¶é…ç½®
- ç°ä»£æµè§ˆå™¨

### 2. å®‰è£…å’Œé…ç½®

```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®
cd comfy-web-service

# ä½¿ç”¨å¯åŠ¨è„šæœ¬è‡ªåŠ¨è®¾ç½®ç¯å¢ƒ
./start.sh setup

# æˆ–æ‰‹åŠ¨è®¾ç½®
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 3. é…ç½®ç¯å¢ƒ

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„ComfyUIè·¯å¾„
nano .env
```

é‡è¦é…ç½®é¡¹ï¼š
```env
# è®¾ç½®ä½ çš„ComfyUIå®‰è£…è·¯å¾„
COMFYUI_PATH=/path/to/your/ComfyUI

# è®¾ç½®æœåŠ¡ç«¯å£ï¼ˆå¯é€‰ï¼‰
PORT=5000

# è®¾ç½®ä¸»æœºåœ°å€ï¼ˆå¯é€‰ï¼‰
HOST=0.0.0.0
```

### 4. æ·»åŠ å·¥ä½œæµ

å°†ä½ çš„ComfyUIå·¥ä½œæµJSONæ–‡ä»¶æ”¾å…¥ `workflow/` ç›®å½•ï¼š

```bash
cp your-workflow.json workflow/
```

æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼š
- `.json` - ComfyUIå¯¼å‡ºçš„å·¥ä½œæµæ–‡ä»¶

### 5. å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼å¯åŠ¨
./start.sh dev

# æˆ–ç”Ÿäº§æ¨¡å¼å¯åŠ¨
./start.sh production

# æˆ–ç›´æ¥è¿è¡ŒPythonæ–‡ä»¶
python app.py
```

### 6. è®¿é—®ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:5000`

åœ¨æ‰‹æœºä¸Šè®¿é—®ï¼š`http://ä½ çš„æœåŠ¡å™¨IP:5000`

## é¡¹ç›®ç»“æ„

```
comfy-web-service/
â”œâ”€â”€ app.py                 # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ config.py             # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–
â”œâ”€â”€ start.sh             # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ env.example          # ç¯å¢ƒé…ç½®ç¤ºä¾‹
â”œâ”€â”€ README.md            # è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ workflow/            # å·¥ä½œæµç›®å½•
â”‚   â”œâ”€â”€ *.json          # ComfyUIå·¥ä½œæµæ–‡ä»¶
â”œâ”€â”€ templates/           # HTMLæ¨¡æ¿
â”‚   â””â”€â”€ index.html      # ä¸»é¡µé¢
â”œâ”€â”€ static/             # é™æ€èµ„æº
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css   # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ app.js      # å‰ç«¯é€»è¾‘
â””â”€â”€ output/             # è¾“å‡ºç›®å½•
```

## ä½¿ç”¨è¯´æ˜

### æ·»åŠ æ–°å·¥ä½œæµ

1. åœ¨ComfyUIä¸­åˆ›å»ºå’Œæµ‹è¯•ä½ çš„å·¥ä½œæµ
2. ä½¿ç”¨ComfyUIçš„"Save"åŠŸèƒ½ä¿å­˜ä¸ºJSONæ–‡ä»¶
3. å°†JSONæ–‡ä»¶å¤åˆ¶åˆ° `workflow/` ç›®å½•
4. åˆ·æ–°Webç•Œé¢å³å¯çœ‹åˆ°æ–°çš„å·¥ä½œæµ

### è¿è¡Œå·¥ä½œæµ

1. åœ¨Webç•Œé¢ä¸­æµè§ˆå¯ç”¨çš„å·¥ä½œæµ
2. ç‚¹å‡»å·¥ä½œæµå¡ç‰‡æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
3. ç‚¹å‡»"è¿è¡Œå·¥ä½œæµ"æŒ‰é’®
4. ç¡®è®¤è¿è¡Œåç­‰å¾…æ‰§è¡Œå®Œæˆ
5. æŸ¥çœ‹å®æ—¶æ‰§è¡ŒçŠ¶æ€å’Œè¾“å‡ºç»“æœ

### ç§»åŠ¨ç«¯ä¼˜åŒ–åŠŸèƒ½

- **è§¦æ‘¸å‹å¥½** - å¤§æŒ‰é’®è®¾è®¡ï¼Œé€‚åˆæ‰‹æŒ‡æ“ä½œ
- **å“åº”å¼å¸ƒå±€** - è‡ªé€‚åº”å„ç§å±å¹•å°ºå¯¸
- **æ»‘åŠ¨æ“ä½œ** - æ”¯æŒæ»‘åŠ¨å’Œè§¦æ‘¸æ‰‹åŠ¿
- **ç¦»çº¿æç¤º** - ç½‘ç»œçŠ¶æ€æ£€æµ‹å’Œæç¤º
- **PWAæ”¯æŒ** - å¯å®‰è£…ä¸ºæ¡Œé¢åº”ç”¨

## APIæ¥å£

### è·å–å·¥ä½œæµåˆ—è¡¨
```http
GET /api/workflows
```

### è¿è¡Œå·¥ä½œæµ
```http
POST /api/run
Content-Type: application/json

{
    "filename": "your-workflow.json"
}
```

### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
```http
GET /api/status/{task_id}
```

### è·å–æ‰€æœ‰ä»»åŠ¡
```http
GET /api/tasks
```

## é…ç½®é€‰é¡¹

| ç¯å¢ƒå˜é‡ | é»˜è®¤å€¼ | è¯´æ˜ |
|---------|--------|------|
| HOST | 0.0.0.0 | æœåŠ¡å™¨ç»‘å®šåœ°å€ |
| PORT | 5000 | æœåŠ¡å™¨ç«¯å£ |
| DEBUG | False | è°ƒè¯•æ¨¡å¼ |
| COMFYUI_PATH | /path/to/ComfyUI | ComfyUIå®‰è£…è·¯å¾„ |
| COMFYUI_OUTPUT_DIR | ./output | è¾“å‡ºç›®å½• |
| MAX_CONCURRENT_TASKS | 3 | æœ€å¤§å¹¶å‘ä»»åŠ¡æ•° |
| TASK_TIMEOUT | 3600 | ä»»åŠ¡è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å·¥ä½œæµä¸æ˜¾ç¤º**
   - æ£€æŸ¥ `workflow/` ç›®å½•æ˜¯å¦å­˜åœ¨
   - ç¡®è®¤JSONæ–‡ä»¶æ ¼å¼æ­£ç¡®
   - æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

2. **æ— æ³•è¿è¡Œå·¥ä½œæµ**
   - æ£€æŸ¥ComfyUIè·¯å¾„é…ç½®
   - ç¡®è®¤ComfyUIä¾èµ–å·²å®‰è£…
   - æ£€æŸ¥æƒé™è®¾ç½®

3. **ç§»åŠ¨ç«¯æ˜¾ç¤ºå¼‚å¸¸**
   - ç¡®ä¿ä½¿ç”¨ç°ä»£æµè§ˆå™¨
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - å°è¯•åˆ·æ–°é¡µé¢

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f comfy-web-service.log

# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
./start.sh dev 2>&1 | tee startup.log
```

## å¼€å‘è¯´æ˜

### æœ¬åœ°å¼€å‘

```bash
# å¼€å‘æ¨¡å¼å¯åŠ¨ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
./start.sh dev

# æˆ–ç›´æ¥ä½¿ç”¨Flask
export FLASK_ENV=development
export FLASK_APP=app.py
flask run --host=0.0.0.0 --port=5000
```

### ç”Ÿäº§éƒ¨ç½²

```bash
# ç”Ÿäº§æ¨¡å¼å¯åŠ¨
./start.sh production

# æˆ–ä½¿ç”¨PM2
pm2 start app.py --interpreter python3 --name comfy-web-service

# æˆ–ä½¿ç”¨systemdæœåŠ¡
sudo systemctl start comfy-web-service
```

### Dockeréƒ¨ç½²

```dockerfile
# Dockerfileç¤ºä¾‹
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 5000

CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "app:app"]
```

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æŸ¥çœ‹é¡¹ç›®Issues
3. æäº¤æ–°çš„Issueæè¿°é—®é¢˜

---

*Created with â¤ï¸ for ComfyUI community*